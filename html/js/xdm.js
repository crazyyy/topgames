!function(t){function e(){var t="";for(i=0;i<5;i++)t+=Math.ceil(15*Math.random()).toString(16);return t}function n(t,e,i,s,o){t[e]?i.apply(s):(o=o||0,1e3>o&&setTimeout(function(){n(t,e,i,s,o+1)},0))}function s(e){setTimeout(function(){var i=document.createElement("script");i.type="text/javascript",i.src=e||t.fastXDM.helperUrl,n(document,"body",function(){document.getElementsByTagName("HEAD")[0].appendChild(i)})},0)}function o(t,e){switch(typeof t){case"string":return e?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t.replace(/&#039;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");case"object":if("[object Array]"===Object.prototype.toString.apply(t)){newValue=[];for(var n=0;n<t.length;n++)newValue[n]=o(t[n],e)}else for(var i in t)newValue={},Object.hasOwnProperty.call(t,i)&&(newValue[i]=o(t[i],e));default:newValue=t}return newValue}function r(t,e){l.loaded?t.apply(e,[l]):u.push([e,t])}function a(){l.loaded=!0;for(var t=u.length;t--;)u[t][1].apply(u[t][0],[l])}function f(t,e){r(function(n){var i=n.json.parse(t);if(i[0]){i[1]||(i[1]=[]);for(var s=i[1].length;s--;)if(i[1][s]._func){var r=i[1][s]._func;i[1][s]=function(){var t=Array.prototype.slice.call(arguments);t.unshift("_func"+r),e.callMethod.apply(e,t)}}else e.options.safe&&(i[1][s]=o(i[1][s],!0));setTimeout(function(){if(!e.methods[i[0]])throw Error("fastXDM: Method "+i[0]+" is undefined");e.methods[i[0]].apply(e,i[1])},0)}})}function c(t,e){for(var n in e)t[n]&&"object"==typeof t[n]?c(t[n],e[n]):t[n]=e[n]}if(!t.fastXDM){var h={},u=[],l={};t.fastXDM={_id:0,helperUrl:("https:"===location.protocol?"https:":"http:")+"//vk.com/js/api/xdmHelper.js",Server:function(n,i,s){this.methods=n||{},this.id=t.fastXDM._id++,this.options=s||{},this.filter=i,this.key=e(),this.methods["%init%"]=this.methods.__fxdm_i=function(){t.fastXDM.run(this.id),this.methods.onInit&&this.methods.onInit()},this.frameName="fXD"+this.key,this.server=!0,h[this.key]=[f,this]},Client:function(e,n){if(this.methods=e||{},this.id=t.fastXDM._id++,this.options=n||{},t.fastXDM.run(this.id),0!=window.name.indexOf("fXD"))throw Error("Wrong window.name property.");this.key=window.name.substr(3),this.caller=window.parent,h[this.key]=[f,this],this.client=!0,t.fastXDM.on("helper",function(){t.fastXDM.onClientStart(this)},this),r(function(t){t.send(this,t.json.stringify(["%init%"]));var e=this.methods;setTimeout(function(){e.onInit&&e.onInit()},0)},this)},onMessage:function(t){if(!t.data)return!1;var e=t.data.substr(0,5);if(h[e]){var n=h[e][1];!n||n.filter&&!n.filter(t.origin)||h[e][0](t.data.substr(6),n)}},setJSON:function(t){l.json=t},getJSON:function(t){return t?void r(function(e){t(e.json)}):l.json},setEnv:function(t){for(i in t)l[i]=t[i];a()},_q:{},on:function(t,e,n){this._q[t]||(this._q[t]=[]),-1==this._q[t]?e.apply(n):this._q[t].push([e,n])},run:function(t){var e=(this._q[t]||[]).length;if(this._q[t]&&e>0)for(var n=0;e>n;n++)this._q[t][n][0].apply(this._q[t][n][1]);this._q[t]=-1},waitFor:n},t.fastXDM.Server.prototype.start=function(e,n){if(e.contentWindow)this.caller=e.contentWindow,this.frame=e,t.fastXDM.on("helper",function(){t.fastXDM.onServerStart(this)},this);else{var i=this;n=n||0,50>n&&setTimeout(function(){i.start.apply(i,[e,n+1])},100)}},t.fastXDM.Server.prototype.destroy=function(){h.splice(h.indexOf(this.key),1)},t.fastXDM.Server.prototype.append=function(t,e){var n=document.createElement("DIV");n.innerHTML='<iframe name="'+this.frameName+'" ></iframe>';var i=n.firstChild,s=this;return setTimeout(function(){i.frameBorder="0",e&&c(i,e),t.insertBefore(i,t.firstChild),s.start(i)},0),i},t.fastXDM.Client.prototype.callMethod=t.fastXDM.Server.prototype.callMethod=function(){for(var e=Array.prototype.slice.call(arguments),i=e.shift(),s=e.length;s--;)if("function"==typeof e[s]){this.funcsCount=(this.funcsCount||0)+1;var a=e[s],f="_func"+this.funcsCount;this.methods[f]=function(){a.apply(this,arguments),delete this.methods[f]},e[s]={_func:this.funcsCount}}else this.options.safe&&(e[s]=o(e[s],!1));n(this,"caller",function(){t.fastXDM.on(this.id,function(){r(function(t){t.send(this,t.json.stringify([i,e]))},this)},this)},this)},t.JSON&&"object"==typeof t.JSON&&t.JSON.parse&&t.JSON.stringify&&'{"a":[1,2,3]}'==t.JSON.stringify({a:[1,2,3]}).replace(/ /g,"")?l.json={parse:t.JSON.parse,stringify:t.JSON.stringify}:t.fastXDM._needJSON=!0,t.postMessage?(l.protocol="p",l.send=function(t,e){t.caller.postMessage(t.key+":"+e,"*")},t.addEventListener?t.addEventListener("message",t.fastXDM.onMessage,!1):t.attachEvent("onmessage",t.fastXDM.onMessage),t.fastXDM._needJSON?(t.fastXDM._onlyJSON=!0,s()):a()):s()}}(window);try{stManager.done("api/xdm.js")}catch(e){}